<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#5b7c89">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Forms &mdash; Silex-MVC</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--<link rel="icon" href="/silex-mvc/favicon.ico">-->
    <link rel="stylesheet" href="/silex-mvc/components/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/silex-mvc/css/style.css?v=6">
    <link rel="stylesheet" href="/silex-mvc/components/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/silex-mvc/components/highlightjs/styles/github.css" />
    
    <link rel="apple-touch-icon" sizes="57x57" href="/silex-mvc/images/silex/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/silex-mvc/images/silex/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/silex-mvc/images/silex/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/silex-mvc/images/silex/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/silex-mvc/images/silex/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/silex-mvc/images/silex/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/silex-mvc/images/silex/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/silex-mvc/images/silex/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/silex-mvc/images/silex/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/silex-mvc/images/silex/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/silex-mvc/images/silex/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/silex-mvc/images/silex/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/silex-mvc/images/silex/favicon-16x16.png">
    <link rel="manifest" href="/silex-mvc/images/silex/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/silex-mvc/images/silex/ms-icon-144x144.png">
    
</head>
<body>
    <a class="fork-me-on-github" href="https://github.com/bsa-git/silex-mvc/" target="_blank"><img src="/silex-mvc/assets/right-red@2x.png" alt="Fork me on GitHub"></a>
    <header class="site">
        <nav class="navbar navbar-default navbar-static-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <div class="site-mascot" title="Silex-MVC"></div>
                    <a class="navbar-brand" href="/silex-mvc/">Silex-MVC</a>
                </div>
                <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/silex-mvc/">About</a>
                        </li>
                        <li >
                            <a href="/silex-mvc/getstarted/">Get Started</a>
                        </li>
                        <li >
                            <a href="/silex-mvc/download/">Download</a>
                        </li>
                        <li >
                            <a href="/silex-mvc/documentation/">Documentation</a>
                        </li>
                        <li >
                            <a href="/silex-mvc/community/">Community</a>
                        </li>
                                            </ul>
                </div>
            </div>
        </nav>
    </header>
        <section class="content">
        <div class="container">
                <div class="row">
        <div class="col-sm-3">
            <div class="sculpin-sidebar">
                <ul class="nav">
                                            <li ><a href="/silex-mvc/getstarted/">Get Started</a>
                                                    </li>
                                            <li ><a href="/silex-mvc/documentation/basic-project/">Basic Project</a>
                                                    </li>
                                            <li ><a href="/silex-mvc/documentation/configuration/">Configuration</a>
                                                    </li>
                                            <li ><a href="/silex-mvc/documentation/web-app">Web application (app)</a>
                                                            <ul class="nav">
                                                                            <li ><a href="/silex-mvc/documentation/web-app/bootstrap/">Loader (Bootstrap.php)</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-app/controllers/">Controllers</a>
                                                                            <li  class="active" ><a href="/silex-mvc/documentation/web-app/forms/">Forms</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-app/models/">Models</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-app/services/">Services</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-app/layouts/">Layouts</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-app/locale/">Localization</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-app/security/">Security</a>
                                                                    </ul>
                                                    </li>
                                            <li ><a href="/silex-mvc/documentation/web-public">Web application (public)</a>
                                                            <ul class="nav">
                                                                            <li ><a href="/silex-mvc/documentation/web-public/main/">Loader (main.js)</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-public/locale/">Localization</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-public/services/">Services</a>
                                                                            <li ><a href="/silex-mvc/documentation/web-public/backbone/">Backbone</a>
                                                                    </ul>
                                                    </li>
                                            <li ><a href="/silex-mvc/documentation/console-app">Console application</a>
                                                            <ul class="nav">
                                                                            <li ><a href="/silex-mvc/documentation/console-app/bootstrap/">Loader (Bootstrap.php)</a>
                                                                            <li ><a href="/silex-mvc/documentation/console-app/configuration/">Configuration</a>
                                                                            <li ><a href="/silex-mvc/documentation/console-app/lifecycle/">Life Cycle</a>
                                                                    </ul>
                                                    </li>
                                    </ul>
            </div>
        </div>
        <div class="col-sm-9">
            <h1>Forms</h1>
            <p>Uses <code>Symfony2</code> <a href="http://symfony.com/doc/current/components/form/index.html">components</a>, 
that facilitate the creation, display, and validation of forms.</p>

<pre><code>|-- app/
    |-- Forms/          # Forms
      |-- Constraints/  # Rules form validation
      |-- PostForm.php  # Form for adding/editing user posts
      `-- RegForm.php   # Form for the registration of a new user
</code></pre>

<p>Consider the main features of the form through the creation of a new message (post).</p>

<h2 id="creating-forms">Creating forms</h2>

<p>With the help of action <code>newAction</code> in the controller <code>app/Controllers/BlogController.php</code>
we are creating a new message (post) and store it in the database.</p>

<p>An example is shown below.</p>

<pre><code>...
// Create object NewPost and set values
$ormPost = new Post();
$ormPost-&gt;setCreated(date($format));
// Create form
$form = $this-&gt;createForm(new PostForm(), $ormPost, array('action' =&gt; "/blog/new"));
$form-&gt;handleRequest($request);

if ($form-&gt;isSubmitted() &amp;&amp; $form-&gt;isValid()) {
    $user = $this-&gt;getUser();
    $username = $user-&gt;getUsername();
    // Create new post
    $models-&gt;load('Post', 'newPost', array('username' =&gt; $username, 'new_post' =&gt; $ormPost));
    ...
}
</code></pre>

<p>Creating a form occurs with the function:</p>

<pre><code>// Create form
$form = $this-&gt;createForm(new PostForm(), $ormPost, array('action' =&gt; "/blog/new"));
</code></pre>

<p>The first parameter is the form object of class <strong>PostForm</strong> <code>app/Forms/PostForm.php</code>,
that defines the form characteristics:</p>

<ul>
<li><strong>Method</strong> (<code>post</code> or <code>get</code>)</li>
<li><strong>Action</strong> (<code>/blog/new</code>)</li>
<li><strong>Form fields</strong> (field type, field options)</li>
<li><strong>Default options</strong> (<code>data_class</code>,<code>csrf_protection</code>, <code>csrf_field_name</code>, <code>intention</code> etc.)</li>
</ul>

<p>The second parameter is the object data of class <strong>Post</strong> <code>app/Models/ORM/Post.php</code>,
that defines the characteristics of <code>post</code> table in the database <code>app/Resources/db/app.db</code>:</p>

<ul>
<li><strong>Column</strong> (<code>name</code>, <code>type</code> etc. )</li>
<li><strong>Relations between tables</strong> (<code>ManyToOne</code>, <code>JoinColumn</code> etc.)</li>
<li><strong>Validation rules table fields</strong></li>
</ul>

<p>The third parameter are form parameters set manually.</p>

<pre><code>array('action' =&gt; "/blog/new")
</code></pre>

<h2 id="validation-of-form">Validation of form</h2>

<p>Validation of form data takes place on two levels:</p>

<ul>
<li><strong>At the server level</strong> </li>
<li><strong>At the client level</strong></li>
</ul>

<p>At the server level, we check the sign of the user to send data and do data validation.
Validation rules are defined in the object data of class <strong>Post</strong> <code>app/Models/ORM/Post.php</code>.</p>

<pre><code>...
if ($form-&gt;isSubmitted() &amp;&amp; $form-&gt;isValid()) {
    ...
}
</code></pre>

<p>At the client level in the template <code>app/Views/Controller/blog/new.html.twig</code>
we add service <code>FormValidation</code> and validation rules for this service.</p>

<pre><code>...
&lt;script type="text/javascript"&gt;
    BSA.ScriptResources.push('FormValidation');
    ...
    addScriptParams('FormValidation',
            {
                form: 'form[name="post"]',
                rules: {
                    "post[created]": {
                        required: true
                    },
                    "post[title]": {
                        required: true,
                        minlength: 5
                    },
                    "post[body]": {
                        required: true
                    }
                }
            });
    ...
&lt;/script&gt;
...
</code></pre>

<h2 id="displaying-the-form">Displaying the form</h2>

<p>View display the form, you can specify when the service configuration <code>Twig</code> in method <code>_iniProviders</code>
of class <strong>Bootstrap</strong> <code>app/Bootstrap.php</code></p>

<pre><code>...
// Twig
$app-&gt;register(
        new Silex\Provider\TwigServiceProvider(), array(
    ...
    #Global form templates
    'twig.form.templates' =&gt; array("Form/bootstrap_3_horizontal_layout.html.twig"),
    ...
));
...
</code></pre>

<p>or in the configuration file <code>app/Resources/Config/config.yml</code></p>

<pre><code>service_providers:
    ...
    twig:
        class: Silex\Provider\TwigServiceProvider
        construct_parameters: ~
        parameters:
            ...
            twig.form.templates:    
                #Global form templates
                - Form/bootstrap_3_horizontal_layout.html.twig
            ...
    ...
</code></pre>

<p>where the parameter <code>#Global form templates</code> is set .</p>

<p>Templates that define the appearance of the form are in <code>app/Views/Form</code>.</p>
        </div>
    </div>
        </div>
    </section>
    <footer class="site">
        <div class="container">
                            <div class="mascot">
                    <a class="ir" href="https://sculpin.io/" target="_blank" title="The site is created using Sculpin Static Site Generator"></a>
                </div>
                <div class="social">
                    <ul>
                        <li>
                            <a href="http://silex.sensiolabs.org/contributors" target="_blank" title="Silex contributors"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></a>
                        </li>
                        <li>
                            <a href="http://symfony.com/blog/" target="_blank" title="Symfony blog"><span class="glyphicon glyphicon-user" aria-hidden="true"></span></a>
                        </li>
                        <li>
                            <a href="http://symfony.com/community" target="_blank" title="Symfony community" ><span class="glyphicon glyphicon-comment" aria-hidden="true"></span></a>
                        </li>
                    </ul>
                </div>
                <div class="copyright">
                    &copy;2016 <a href="https://github.com/bsa-git/" target="_blank">Sergei Beskorovainyi</a>
                    (<a href="mailto:bsa2657@jandex.ru?subject=Silex-MVC">Email</a>)
                </div>
                    </div>
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/silex-mvc/components/jquery/jquery.min.js"><\/script>')</script>
    <script defer src="/silex-mvc/components/bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
